{
  "url": "https://api.github.com/repos/openclaw/openclaw/issues/10403",
  "repository_url": "https://api.github.com/repos/openclaw/openclaw",
  "labels_url": "https://api.github.com/repos/openclaw/openclaw/issues/10403/labels{/name}",
  "comments_url": "https://api.github.com/repos/openclaw/openclaw/issues/10403/comments",
  "events_url": "https://api.github.com/repos/openclaw/openclaw/issues/10403/events",
  "html_url": "https://github.com/openclaw/openclaw/issues/10403",
  "id": 3906716084,
  "node_id": "I_kwDOQb6kR87o28G0",
  "number": 10403,
  "title": "Cron: `every` schedule jobs stop firing after repeated errors, no catch-up mechanism",
  "user": {
    "login": "mrz1836",
    "id": 3743002,
    "node_id": "MDQ6VXNlcjM3NDMwMDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3743002?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mrz1836",
    "html_url": "https://github.com/mrz1836",
    "followers_url": "https://api.github.com/users/mrz1836/followers",
    "following_url": "https://api.github.com/users/mrz1836/following{/other_user}",
    "gists_url": "https://api.github.com/users/mrz1836/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mrz1836/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mrz1836/subscriptions",
    "organizations_url": "https://api.github.com/users/mrz1836/orgs",
    "repos_url": "https://api.github.com/users/mrz1836/repos",
    "events_url": "https://api.github.com/users/mrz1836/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mrz1836/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 9,
  "created_at": "2026-02-06T13:15:59Z",
  "updated_at": "2026-02-07T07:53:48Z",
  "closed_at": "2026-02-07T02:11:13Z",
  "author_association": "NONE",
  "type": null,
  "active_lock_reason": null,
  "sub_issues_summary": {
    "total": 0,
    "completed": 0,
    "percent_completed": 0
  },
  "issue_dependencies_summary": {
    "blocked_by": 0,
    "total_blocked_by": 0,
    "blocking": 0,
    "total_blocking": 0
  },
  "body": "## Summary\n\n`every` (interval) schedule jobs stopped firing for ~23 hours after encountering repeated LLM errors (rate limits, timeouts). The scheduler jumped `nextRunAtMs` far into the future instead of retrying on the normal interval.\n\n## Environment\n- OpenClaw version: 2026.2.3-1\n- OS: macOS 15.7.3 (arm64)\n- Node: 25.6.0\n\n## Steps to Reproduce\n\n1. Create an `every` schedule job (e.g., hourly):\n```json\n{\n  \"schedule\": {\n    \"kind\": \"every\",\n    \"everyMs\": 3600000\n  }\n}\n```\n\n2. Let the job encounter multiple consecutive errors (rate limits, timeouts, connection errors)\n\n3. Observe that `nextRunAtMs` jumps far into the future (e.g., 24+ hours) instead of retrying on the next interval\n\n## Expected Behavior\n\n- After transient errors, the job should retry on the next scheduled interval (1 hour later), not jump 24+ hours ahead\n- Optional: A configurable \"max catch-up\" setting to handle missed runs after downtime\n\n## Actual Behavior\n\n- After several errors around 09:00 EST on Feb 5, the hourly jobs didn't fire again until manually recreated on Feb 6\n- The `nextRunAtMs` was set to ~09:00 EST the next day, skipping ~23 hourly runs\n- Run history showed errors like:\n  ```\n  Error: All models failed (4): anthropic/claude-opus-4-5: LLM request timed out. (unknown) | anthropic/claude-sonnet-4-5: No available auth profile (rate_limit) | ...\n  ```\n\n## Workaround\n\nDelete and recreate the job with a fresh `anchorMs` to reset the schedule state:\n```bash\nopenclaw cron remove <job-id>\nopenclaw cron add --schedule.kind=every --schedule.everyMs=3600000 --schedule.anchorMs=<recent-timestamp> ...\n```\n\n## Additional Context\n\n- `cron` expression jobs (e.g., `0 7 * * *`) were unaffected and continued running normally\n- Only `every` (interval) jobs exhibited this behavior\n- The gateway was running continuously during this period (not restarted until troubleshooting)\n\n## Suggested Fix\n\n1. After an error, calculate next run as `max(now, lastRunAtMs) + everyMs` rather than jumping to a much later time\n2. Consider a `maxSkip` or `catchUp` option for interval schedules\n3. Add logging when a job's next run is calculated to be significantly later than expected",
  "closed_by": {
    "login": "tyler6204",
    "id": 64381258,
    "node_id": "MDQ6VXNlcjY0MzgxMjU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/64381258?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tyler6204",
    "html_url": "https://github.com/tyler6204",
    "followers_url": "https://api.github.com/users/tyler6204/followers",
    "following_url": "https://api.github.com/users/tyler6204/following{/other_user}",
    "gists_url": "https://api.github.com/users/tyler6204/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tyler6204/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tyler6204/subscriptions",
    "organizations_url": "https://api.github.com/users/tyler6204/orgs",
    "repos_url": "https://api.github.com/users/tyler6204/repos",
    "events_url": "https://api.github.com/users/tyler6204/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tyler6204/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/openclaw/openclaw/issues/10403/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/openclaw/openclaw/issues/10403/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed",
  "pinned_comment": null
}
