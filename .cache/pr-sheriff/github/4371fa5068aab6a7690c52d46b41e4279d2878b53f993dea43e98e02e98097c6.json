{
  "url": "https://api.github.com/repos/openclaw/openclaw/issues/9565",
  "repository_url": "https://api.github.com/repos/openclaw/openclaw",
  "labels_url": "https://api.github.com/repos/openclaw/openclaw/issues/9565/labels{/name}",
  "comments_url": "https://api.github.com/repos/openclaw/openclaw/issues/9565/comments",
  "events_url": "https://api.github.com/repos/openclaw/openclaw/issues/9565/events",
  "html_url": "https://github.com/openclaw/openclaw/issues/9565",
  "id": 3900992553,
  "node_id": "I_kwDOQb6kR87ohGwp",
  "number": 9565,
  "title": "Cron scheduler doesn't wake for newly added 'at' jobs",
  "user": {
    "login": "thisischappy",
    "id": 257418353,
    "node_id": "U_kgDOD1fkcQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/257418353?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/thisischappy",
    "html_url": "https://github.com/thisischappy",
    "followers_url": "https://api.github.com/users/thisischappy/followers",
    "following_url": "https://api.github.com/users/thisischappy/following{/other_user}",
    "gists_url": "https://api.github.com/users/thisischappy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/thisischappy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thisischappy/subscriptions",
    "organizations_url": "https://api.github.com/users/thisischappy/orgs",
    "repos_url": "https://api.github.com/users/thisischappy/repos",
    "events_url": "https://api.github.com/users/thisischappy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/thisischappy/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 1,
  "created_at": "2026-02-05T11:05:25Z",
  "updated_at": "2026-02-07T02:06:52Z",
  "closed_at": "2026-02-07T02:06:52Z",
  "author_association": "NONE",
  "type": null,
  "active_lock_reason": null,
  "sub_issues_summary": {
    "total": 0,
    "completed": 0,
    "percent_completed": 0
  },
  "issue_dependencies_summary": {
    "blocked_by": 0,
    "total_blocked_by": 0,
    "blocking": 0,
    "total_blocking": 0
  },
  "body": "## Summary\n\nWhen adding a new one-time `at` cron job, the scheduler's `nextWakeAtMs` is not recalculated. If the new job's scheduled time is sooner than the current next wake, the job will be skipped entirely.\n\n## Repro Steps\n\n1. At 7:00 PM, create two one-time `at` jobs scheduled for 1:00 AM and 2:00 AM\n2. Verify jobs are created successfully (they appear in `cron list`)\n3. Wait until after 2:00 AM\n4. Check job state â€” jobs have empty state (`{}`), never ran\n5. `cron status` shows `nextWakeAtMs` jumped to 7:00 AM (the next recurring cron), skipping the 1am/2am jobs\n\n## Expected Behavior\n\nWhen a new `at` job is added, if its `atMs` is sooner than the current `nextWakeAtMs`, the scheduler should update its wake time to fire for the new job.\n\n## Actual Behavior\n\nThe scheduler's `nextWakeAtMs` is not updated when new jobs are added. One-time `at` jobs scheduled between now and the next recurring cron are silently skipped.\n\n## Additional Notes\n\n- Manual `cron run` on the missed jobs returns `{\"ran\": false, \"reason\": \"not-due\"}` because the time has passed\n- Jobs remain in the list with empty state indefinitely\n- This affects the Evening Build Planning workflow where overnight build tasks are approved and scheduled for 1-2am\n\n## Environment\n\n- OpenClaw version: 2026.2.2-3\n- macOS (arm64)\n",
  "closed_by": {
    "login": "tyler6204",
    "id": 64381258,
    "node_id": "MDQ6VXNlcjY0MzgxMjU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/64381258?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tyler6204",
    "html_url": "https://github.com/tyler6204",
    "followers_url": "https://api.github.com/users/tyler6204/followers",
    "following_url": "https://api.github.com/users/tyler6204/following{/other_user}",
    "gists_url": "https://api.github.com/users/tyler6204/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tyler6204/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tyler6204/subscriptions",
    "organizations_url": "https://api.github.com/users/tyler6204/orgs",
    "repos_url": "https://api.github.com/users/tyler6204/repos",
    "events_url": "https://api.github.com/users/tyler6204/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tyler6204/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/openclaw/openclaw/issues/9565/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/openclaw/openclaw/issues/9565/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed",
  "pinned_comment": null
}
