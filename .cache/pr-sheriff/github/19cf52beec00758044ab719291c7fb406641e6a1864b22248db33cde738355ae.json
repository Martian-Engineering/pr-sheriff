{
  "url": "https://api.github.com/repos/openclaw/openclaw/pulls/17360",
  "id": 3287275997,
  "node_id": "PR_kwDOQb6kR87D79nd",
  "html_url": "https://github.com/openclaw/openclaw/pull/17360",
  "diff_url": "https://github.com/openclaw/openclaw/pull/17360.diff",
  "patch_url": "https://github.com/openclaw/openclaw/pull/17360.patch",
  "issue_url": "https://api.github.com/repos/openclaw/openclaw/issues/17360",
  "number": 17360,
  "state": "open",
  "locked": false,
  "title": "fix(doctor): skip embedding provider check when memory backend is QMD",
  "user": {
    "login": "nikhil8182",
    "id": 34933256,
    "node_id": "MDQ6VXNlcjM0OTMzMjU2",
    "avatar_url": "https://avatars.githubusercontent.com/u/34933256?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikhil8182",
    "html_url": "https://github.com/nikhil8182",
    "followers_url": "https://api.github.com/users/nikhil8182/followers",
    "following_url": "https://api.github.com/users/nikhil8182/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikhil8182/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikhil8182/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikhil8182/subscriptions",
    "organizations_url": "https://api.github.com/users/nikhil8182/orgs",
    "repos_url": "https://api.github.com/users/nikhil8182/repos",
    "events_url": "https://api.github.com/users/nikhil8182/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikhil8182/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "body": "## Summary\n\n- **Problem:** `openclaw doctor` falsely warns \"no embedding provider configured\" when using QMD as the memory backend, even though QMD handles embeddings internally (e.g. embeddinggemma)\n- **Fix:** Added an early return in `noteMemorySearchHealth()` that detects the QMD backend via `resolveMemoryBackendConfig()` and skips the embedding provider check\n- **Test:** Added a regression test covering the QMD backend scenario\n\n## Change Type (select all)\n\n- [x] Bug fix\n- [ ] Feature\n- [ ] Refactor\n- [ ] Docs\n- [ ] Security hardening\n- [ ] Chore/infra\n\n## Scope (select all touched areas)\n\n- [ ] Gateway / orchestration\n- [ ] Skills / tool execution\n- [ ] Auth / tokens\n- [x] Memory / storage\n- [ ] Integrations\n- [ ] API / contracts\n- [x] UI / DX\n- [ ] CI/CD / infra\n\n## Linked Issue/PR\n\n- Closes #17263\n\n## User-visible / Behavior Changes\n\n`openclaw doctor` no longer shows a false warning about missing embedding providers when the memory backend is set to `qmd`.\n\n## Security Impact (required)\n\n- New permissions/capabilities? No\n- Secrets/tokens handling changed? No\n- New/changed network calls? No\n- Command/tool execution surface changed? No\n- Data access scope changed? No\n\n## Repro + Verification\n\n### Environment\n\n- OS: macOS (arm64)\n- Runtime: Node v22.22.0\n- OpenClaw: v2026.2.14+\n\n### Steps\n\n1. Set `memory.backend: \"qmd\"` in `openclaw.json`\n2. Configure QMD with local embeddings (e.g. embeddinggemma)\n3. Run `openclaw doctor`\n\n### Expected\n\nNo warning about embedding providers.\n\n### Actual (before fix)\n\nShows \"Memory search is enabled but no embedding provider is configured.\"\n\n## Evidence\n\n- [x] Failing test/log before + passing after\n\nAll 4 tests pass (3 existing + 1 new regression test):\n\n```\n âœ“ src/commands/doctor-memory-search.test.ts (4 tests) 3ms\n   âœ“ does not warn when remote apiKey is configured for explicit provider\n   âœ“ does not warn in auto mode when remote apiKey is configured\n   âœ“ does not warn when memory backend is qmd (#17263)\n   âœ“ resolves provider auth from the default agent directory\n```\n\n## Human Verification (required)\n\n- Verified: QMD backend path returns early without emitting a note\n- Verified: Existing tests still pass (non-QMD flows unaffected)\n- Not verified: Live `openclaw doctor` on a system with QMD installed\n\n## Compatibility / Migration\n\n- Backward compatible? Yes\n- Config/env changes? No\n- Migration needed? No\n\n## AI-Assisted ðŸ¤–\n\nThis PR was AI-assisted (Claude). The fix and test were manually reviewed and verified against the codebase.\n\nlobster-biscuit\n\nMade with [Cursor](https://cursor.com)\n\n<!-- greptile_comment -->\n\n<h3>Greptile Summary</h3>\n\nFixes a false-positive warning in `openclaw doctor` where it incorrectly reported \"no embedding provider configured\" when using the QMD memory backend. QMD handles embeddings internally (e.g. via embeddinggemma), so the embedding provider check is unnecessary.\n\n- Adds an early return in `noteMemorySearchHealth()` that detects the QMD backend via `resolveMemoryBackendConfig()` and skips the embedding provider check\n- Adds a regression test covering the QMD backend scenario, properly mocking `resolveMemoryBackendConfig` with a default \"builtin\" return so existing tests remain unaffected\n- Clean, minimal change that correctly addresses the reported issue (#17263)\n\n<h3>Confidence Score: 5/5</h3>\n\n- This PR is safe to merge â€” it's a minimal, well-scoped fix with proper test coverage.\n- The change is a small, targeted early return that correctly detects the QMD backend and skips an inapplicable embedding provider check. The logic is sound: QMD handles embeddings internally, so the warning was a false positive. The fix is placed correctly after the memory-search-disabled check. The new test properly mocks the backend config and verifies both the QMD path and that existing non-QMD tests remain unaffected. No edge cases or regressions identified.\n- No files require special attention.\n\n<sub>Last reviewed commit: faa219b</sub>\n\n<!-- greptile_other_comments_section -->\n\n<sub>(2/5) Greptile learns from your feedback when you react with thumbs up/down!</sub>\n\n<!-- /greptile_comment -->",
  "created_at": "2026-02-15T17:48:02Z",
  "updated_at": "2026-02-15T18:46:03Z",
  "closed_at": null,
  "merged_at": null,
  "merge_commit_sha": "f12d84d24e9fe04a5aa54f050f8d37cf5e9c1c2f",
  "assignee": null,
  "assignees": [],
  "requested_reviewers": [],
  "requested_teams": [],
  "labels": [
    {
      "id": 10069934305,
      "node_id": "LA_kwDOQb6kR88AAAACWDcA4Q",
      "url": "https://api.github.com/repos/openclaw/openclaw/labels/commands",
      "name": "commands",
      "color": "0052cc",
      "default": false,
      "description": "Command implementations"
    },
    {
      "id": 10190106613,
      "node_id": "LA_kwDOQb6kR88AAAACX2Cv9Q",
      "url": "https://api.github.com/repos/openclaw/openclaw/labels/size:%20XS",
      "name": "size: XS",
      "color": "b76e79",
      "default": false,
      "description": null
    }
  ],
  "milestone": null,
  "draft": false,
  "commits_url": "https://api.github.com/repos/openclaw/openclaw/pulls/17360/commits",
  "review_comments_url": "https://api.github.com/repos/openclaw/openclaw/pulls/17360/comments",
  "review_comment_url": "https://api.github.com/repos/openclaw/openclaw/pulls/comments{/number}",
  "comments_url": "https://api.github.com/repos/openclaw/openclaw/issues/17360/comments",
  "statuses_url": "https://api.github.com/repos/openclaw/openclaw/statuses/faa219bac90604055e19fffd67485f96728b8330",
  "head": {
    "label": "nikhil8182:fix/doctor-qmd-embedding-false-positive",
    "ref": "fix/doctor-qmd-embedding-false-positive",
    "sha": "faa219bac90604055e19fffd67485f96728b8330",
    "user": {
      "login": "nikhil8182",
      "id": 34933256,
      "node_id": "MDQ6VXNlcjM0OTMzMjU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/34933256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikhil8182",
      "html_url": "https://github.com/nikhil8182",
      "followers_url": "https://api.github.com/users/nikhil8182/followers",
      "following_url": "https://api.github.com/users/nikhil8182/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikhil8182/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikhil8182/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikhil8182/subscriptions",
      "organizations_url": "https://api.github.com/users/nikhil8182/orgs",
      "repos_url": "https://api.github.com/users/nikhil8182/repos",
      "events_url": "https://api.github.com/users/nikhil8182/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikhil8182/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "repo": {
      "id": 1158637136,
      "node_id": "R_kgDORQ9mUA",
      "name": "openclaw",
      "full_name": "nikhil8182/openclaw",
      "private": false,
      "owner": {
        "login": "nikhil8182",
        "id": 34933256,
        "node_id": "MDQ6VXNlcjM0OTMzMjU2",
        "avatar_url": "https://avatars.githubusercontent.com/u/34933256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nikhil8182",
        "html_url": "https://github.com/nikhil8182",
        "followers_url": "https://api.github.com/users/nikhil8182/followers",
        "following_url": "https://api.github.com/users/nikhil8182/following{/other_user}",
        "gists_url": "https://api.github.com/users/nikhil8182/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/nikhil8182/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/nikhil8182/subscriptions",
        "organizations_url": "https://api.github.com/users/nikhil8182/orgs",
        "repos_url": "https://api.github.com/users/nikhil8182/repos",
        "events_url": "https://api.github.com/users/nikhil8182/events{/privacy}",
        "received_events_url": "https://api.github.com/users/nikhil8182/received_events",
        "type": "User",
        "user_view_type": "public",
        "site_admin": false
      },
      "html_url": "https://github.com/nikhil8182/openclaw",
      "description": "Your own personal AI assistant. Any OS. Any Platform. The lobster way. ðŸ¦ž ",
      "fork": true,
      "url": "https://api.github.com/repos/nikhil8182/openclaw",
      "forks_url": "https://api.github.com/repos/nikhil8182/openclaw/forks",
      "keys_url": "https://api.github.com/repos/nikhil8182/openclaw/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/nikhil8182/openclaw/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/nikhil8182/openclaw/teams",
      "hooks_url": "https://api.github.com/repos/nikhil8182/openclaw/hooks",
      "issue_events_url": "https://api.github.com/repos/nikhil8182/openclaw/issues/events{/number}",
      "events_url": "https://api.github.com/repos/nikhil8182/openclaw/events",
      "assignees_url": "https://api.github.com/repos/nikhil8182/openclaw/assignees{/user}",
      "branches_url": "https://api.github.com/repos/nikhil8182/openclaw/branches{/branch}",
      "tags_url": "https://api.github.com/repos/nikhil8182/openclaw/tags",
      "blobs_url": "https://api.github.com/repos/nikhil8182/openclaw/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/nikhil8182/openclaw/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/nikhil8182/openclaw/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/nikhil8182/openclaw/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/nikhil8182/openclaw/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/nikhil8182/openclaw/languages",
      "stargazers_url": "https://api.github.com/repos/nikhil8182/openclaw/stargazers",
      "contributors_url": "https://api.github.com/repos/nikhil8182/openclaw/contributors",
      "subscribers_url": "https://api.github.com/repos/nikhil8182/openclaw/subscribers",
      "subscription_url": "https://api.github.com/repos/nikhil8182/openclaw/subscription",
      "commits_url": "https://api.github.com/repos/nikhil8182/openclaw/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/nikhil8182/openclaw/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/nikhil8182/openclaw/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/nikhil8182/openclaw/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/nikhil8182/openclaw/contents/{+path}",
      "compare_url": "https://api.github.com/repos/nikhil8182/openclaw/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/nikhil8182/openclaw/merges",
      "archive_url": "https://api.github.com/repos/nikhil8182/openclaw/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/nikhil8182/openclaw/downloads",
      "issues_url": "https://api.github.com/repos/nikhil8182/openclaw/issues{/number}",
      "pulls_url": "https://api.github.com/repos/nikhil8182/openclaw/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/nikhil8182/openclaw/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/nikhil8182/openclaw/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/nikhil8182/openclaw/labels{/name}",
      "releases_url": "https://api.github.com/repos/nikhil8182/openclaw/releases{/id}",
      "deployments_url": "https://api.github.com/repos/nikhil8182/openclaw/deployments",
      "created_at": "2026-02-15T17:36:21Z",
      "updated_at": "2026-02-15T17:36:21Z",
      "pushed_at": "2026-02-15T17:47:39Z",
      "git_url": "git://github.com/nikhil8182/openclaw.git",
      "ssh_url": "git@github.com:nikhil8182/openclaw.git",
      "clone_url": "https://github.com/nikhil8182/openclaw.git",
      "svn_url": "https://github.com/nikhil8182/openclaw",
      "homepage": "https://openclaw.ai",
      "size": 192821,
      "stargazers_count": 0,
      "watchers_count": 0,
      "language": null,
      "has_issues": false,
      "has_projects": true,
      "has_downloads": true,
      "has_wiki": false,
      "has_pages": false,
      "has_discussions": false,
      "forks_count": 0,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 0,
      "license": {
        "key": "mit",
        "name": "MIT License",
        "spdx_id": "MIT",
        "url": "https://api.github.com/licenses/mit",
        "node_id": "MDc6TGljZW5zZTEz"
      },
      "allow_forking": true,
      "is_template": false,
      "web_commit_signoff_required": false,
      "has_pull_requests": true,
      "pull_request_creation_policy": "all",
      "topics": [],
      "visibility": "public",
      "forks": 0,
      "open_issues": 0,
      "watchers": 0,
      "default_branch": "main"
    }
  },
  "base": {
    "label": "openclaw:main",
    "ref": "main",
    "sha": "f92900fc2011506018f0a45acf1ef92e46bc55a0",
    "user": {
      "login": "openclaw",
      "id": 252820863,
      "node_id": "O_kgDODxG9fw",
      "avatar_url": "https://avatars.githubusercontent.com/u/252820863?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/openclaw",
      "html_url": "https://github.com/openclaw",
      "followers_url": "https://api.github.com/users/openclaw/followers",
      "following_url": "https://api.github.com/users/openclaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/openclaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/openclaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/openclaw/subscriptions",
      "organizations_url": "https://api.github.com/users/openclaw/orgs",
      "repos_url": "https://api.github.com/users/openclaw/repos",
      "events_url": "https://api.github.com/users/openclaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/openclaw/received_events",
      "type": "Organization",
      "user_view_type": "public",
      "site_admin": false
    },
    "repo": {
      "id": 1103012935,
      "node_id": "R_kgDOQb6kRw",
      "name": "openclaw",
      "full_name": "openclaw/openclaw",
      "private": false,
      "owner": {
        "login": "openclaw",
        "id": 252820863,
        "node_id": "O_kgDODxG9fw",
        "avatar_url": "https://avatars.githubusercontent.com/u/252820863?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/openclaw",
        "html_url": "https://github.com/openclaw",
        "followers_url": "https://api.github.com/users/openclaw/followers",
        "following_url": "https://api.github.com/users/openclaw/following{/other_user}",
        "gists_url": "https://api.github.com/users/openclaw/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/openclaw/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/openclaw/subscriptions",
        "organizations_url": "https://api.github.com/users/openclaw/orgs",
        "repos_url": "https://api.github.com/users/openclaw/repos",
        "events_url": "https://api.github.com/users/openclaw/events{/privacy}",
        "received_events_url": "https://api.github.com/users/openclaw/received_events",
        "type": "Organization",
        "user_view_type": "public",
        "site_admin": false
      },
      "html_url": "https://github.com/openclaw/openclaw",
      "description": "Your own personal AI assistant. Any OS. Any Platform. The lobster way. ðŸ¦ž ",
      "fork": false,
      "url": "https://api.github.com/repos/openclaw/openclaw",
      "forks_url": "https://api.github.com/repos/openclaw/openclaw/forks",
      "keys_url": "https://api.github.com/repos/openclaw/openclaw/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/openclaw/openclaw/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/openclaw/openclaw/teams",
      "hooks_url": "https://api.github.com/repos/openclaw/openclaw/hooks",
      "issue_events_url": "https://api.github.com/repos/openclaw/openclaw/issues/events{/number}",
      "events_url": "https://api.github.com/repos/openclaw/openclaw/events",
      "assignees_url": "https://api.github.com/repos/openclaw/openclaw/assignees{/user}",
      "branches_url": "https://api.github.com/repos/openclaw/openclaw/branches{/branch}",
      "tags_url": "https://api.github.com/repos/openclaw/openclaw/tags",
      "blobs_url": "https://api.github.com/repos/openclaw/openclaw/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/openclaw/openclaw/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/openclaw/openclaw/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/openclaw/openclaw/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/openclaw/openclaw/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/openclaw/openclaw/languages",
      "stargazers_url": "https://api.github.com/repos/openclaw/openclaw/stargazers",
      "contributors_url": "https://api.github.com/repos/openclaw/openclaw/contributors",
      "subscribers_url": "https://api.github.com/repos/openclaw/openclaw/subscribers",
      "subscription_url": "https://api.github.com/repos/openclaw/openclaw/subscription",
      "commits_url": "https://api.github.com/repos/openclaw/openclaw/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/openclaw/openclaw/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/openclaw/openclaw/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/openclaw/openclaw/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/openclaw/openclaw/contents/{+path}",
      "compare_url": "https://api.github.com/repos/openclaw/openclaw/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/openclaw/openclaw/merges",
      "archive_url": "https://api.github.com/repos/openclaw/openclaw/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/openclaw/openclaw/downloads",
      "issues_url": "https://api.github.com/repos/openclaw/openclaw/issues{/number}",
      "pulls_url": "https://api.github.com/repos/openclaw/openclaw/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/openclaw/openclaw/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/openclaw/openclaw/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/openclaw/openclaw/labels{/name}",
      "releases_url": "https://api.github.com/repos/openclaw/openclaw/releases{/id}",
      "deployments_url": "https://api.github.com/repos/openclaw/openclaw/deployments",
      "created_at": "2025-11-24T10:16:47Z",
      "updated_at": "2026-02-15T19:27:41Z",
      "pushed_at": "2026-02-15T19:25:32Z",
      "git_url": "git://github.com/openclaw/openclaw.git",
      "ssh_url": "git@github.com:openclaw/openclaw.git",
      "clone_url": "https://github.com/openclaw/openclaw.git",
      "svn_url": "https://github.com/openclaw/openclaw",
      "homepage": "https://openclaw.ai",
      "size": 192936,
      "stargazers_count": 196482,
      "watchers_count": 196482,
      "language": "TypeScript",
      "has_issues": true,
      "has_projects": false,
      "has_downloads": true,
      "has_wiki": false,
      "has_pages": true,
      "has_discussions": true,
      "forks_count": 34070,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 6295,
      "license": {
        "key": "mit",
        "name": "MIT License",
        "spdx_id": "MIT",
        "url": "https://api.github.com/licenses/mit",
        "node_id": "MDc6TGljZW5zZTEz"
      },
      "allow_forking": true,
      "is_template": false,
      "web_commit_signoff_required": false,
      "has_pull_requests": true,
      "pull_request_creation_policy": "all",
      "topics": [
        "ai",
        "assistant",
        "crustacean",
        "molty",
        "openclaw",
        "own-your-data",
        "personal"
      ],
      "visibility": "public",
      "forks": 34070,
      "open_issues": 6295,
      "watchers": 196482,
      "default_branch": "main"
    }
  },
  "_links": {
    "self": {
      "href": "https://api.github.com/repos/openclaw/openclaw/pulls/17360"
    },
    "html": {
      "href": "https://github.com/openclaw/openclaw/pull/17360"
    },
    "issue": {
      "href": "https://api.github.com/repos/openclaw/openclaw/issues/17360"
    },
    "comments": {
      "href": "https://api.github.com/repos/openclaw/openclaw/issues/17360/comments"
    },
    "review_comments": {
      "href": "https://api.github.com/repos/openclaw/openclaw/pulls/17360/comments"
    },
    "review_comment": {
      "href": "https://api.github.com/repos/openclaw/openclaw/pulls/comments{/number}"
    },
    "commits": {
      "href": "https://api.github.com/repos/openclaw/openclaw/pulls/17360/commits"
    },
    "statuses": {
      "href": "https://api.github.com/repos/openclaw/openclaw/statuses/faa219bac90604055e19fffd67485f96728b8330"
    }
  },
  "author_association": "NONE",
  "auto_merge": null,
  "active_lock_reason": null,
  "merged": false,
  "mergeable": null,
  "rebaseable": null,
  "mergeable_state": "unknown",
  "merged_by": null,
  "comments": 0,
  "review_comments": 0,
  "maintainer_can_modify": true,
  "commits": 1,
  "additions": 37,
  "deletions": 0,
  "changed_files": 2
}
