{
  "url": "https://api.github.com/repos/openclaw/openclaw/issues/10208",
  "repository_url": "https://api.github.com/repos/openclaw/openclaw",
  "labels_url": "https://api.github.com/repos/openclaw/openclaw/issues/10208/labels{/name}",
  "comments_url": "https://api.github.com/repos/openclaw/openclaw/issues/10208/comments",
  "events_url": "https://api.github.com/repos/openclaw/openclaw/issues/10208/events",
  "html_url": "https://github.com/openclaw/openclaw/issues/10208",
  "id": 3905282894,
  "node_id": "I_kwDOQb6kR87oxeNO",
  "number": 10208,
  "title": "[Bug]: Cron Store Silently Returns Empty Jobs on Any Read Error",
  "user": {
    "login": "coygeek",
    "id": 65363919,
    "node_id": "MDQ6VXNlcjY1MzYzOTE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/65363919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/coygeek",
    "html_url": "https://github.com/coygeek",
    "followers_url": "https://api.github.com/users/coygeek/followers",
    "following_url": "https://api.github.com/users/coygeek/following{/other_user}",
    "gists_url": "https://api.github.com/users/coygeek/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/coygeek/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/coygeek/subscriptions",
    "organizations_url": "https://api.github.com/users/coygeek/orgs",
    "repos_url": "https://api.github.com/users/coygeek/repos",
    "events_url": "https://api.github.com/users/coygeek/events{/privacy}",
    "received_events_url": "https://api.github.com/users/coygeek/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 1,
  "created_at": "2026-02-06T07:04:36Z",
  "updated_at": "2026-02-07T21:14:40Z",
  "closed_at": "2026-02-07T02:04:49Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "sub_issues_summary": {
    "total": 0,
    "completed": 0,
    "percent_completed": 0
  },
  "issue_dependencies_summary": {
    "blocked_by": 0,
    "total_blocked_by": 0,
    "blocking": 0,
    "total_blocking": 0
  },
  "body": "## Summary\n\nThe `loadCronStore` function in `src/cron/store.ts` catches all errors and returns an empty job list. When the cron jobs file is corrupted, has permission issues, or contains malformed JSON5, all scheduled jobs silently disappear. The subsequent save operation overwrites the (potentially recoverable) file with empty data.\n\n## Affected Code\n\n**File:** `src/cron/store.ts:22-34`\n\n```typescript\nexport async function loadCronStore(storePath: string): Promise<CronStoreFile> {\n  try {\n    const raw = await fs.promises.readFile(storePath, \"utf-8\");\n    const parsed = JSON5.parse(raw);\n    const jobs = Array.isArray(parsed?.jobs) ? (parsed?.jobs as never[]) : [];\n    return {\n      version: 1,\n      jobs: jobs.filter(Boolean) as never as CronStoreFile[\"jobs\"],\n    };\n  } catch {\n    return { version: 1, jobs: [] };  // Silent data loss\n  }\n}\n```\n\nThe bare `catch` treats every error (EACCES, EIO, malformed JSON5) the same as ENOENT (file not found), returning an empty store. Callers like `ensureLoaded()` then persist the empty store, overwriting the original file.\n\n## Steps to Reproduce\n\n1. Configure several cron jobs for automated operations\n2. Corrupt the cron store file (inject invalid JSON5, change permissions, or simulate disk error)\n3. Restart gateway or trigger config reload\n4. `loadCronStore` catches error, returns empty jobs\n5. All scheduled automation silently stops\n6. No warning in logs, no indication to operator\n\n## Expected Behavior\n\n- ENOENT (file not found) should return an empty store (this is normal for first run)\n- All other errors (EACCES, EIO, corrupted JSON) should throw so the caller can handle the failure explicitly\n- The corrupted file should be preserved for recovery\n\n## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 7.7 / 10.0 |\n| **Severity** | High |\n| **Vector** | CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H |\n\n## References\n\n- **CWE:** [CWE-755](https://cwe.mitre.org/data/definitions/755.html) - Improper Handling of Exceptional Conditions\n\n\n\n## Attack Surface\n\n**How is this reached?**\n- [ ] Network (HTTP/WebSocket endpoint, API call)\n- [ ] Adjacent Network (same LAN, requires network proximity)\n- [x] Local (local file, CLI argument, environment variable)\n- [ ] Physical (requires physical access to machine)\n\n**Authentication required?**\n- [x] None (unauthenticated/public access)\n- [ ] Low (any authenticated user)\n- [ ] High (admin/privileged user only)\n\n**Entry point:** Cron store file read on startup or reload\n\n\n\n## Exploit Conditions\n\n**Complexity:**\n- [x] Low (no special conditions, works reliably)\n- [ ] High (requires race condition, specific config, or timing)\n\n**User interaction:**\n- [x] None (automatic, no victim action needed)\n- [ ] Required (victim must click, visit, or perform action)\n\n**Prerequisites:** File corruption, permission change, or disk error\n\n",
  "closed_by": {
    "login": "tyler6204",
    "id": 64381258,
    "node_id": "MDQ6VXNlcjY0MzgxMjU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/64381258?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tyler6204",
    "html_url": "https://github.com/tyler6204",
    "followers_url": "https://api.github.com/users/tyler6204/followers",
    "following_url": "https://api.github.com/users/tyler6204/following{/other_user}",
    "gists_url": "https://api.github.com/users/tyler6204/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tyler6204/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tyler6204/subscriptions",
    "organizations_url": "https://api.github.com/users/tyler6204/orgs",
    "repos_url": "https://api.github.com/users/tyler6204/repos",
    "events_url": "https://api.github.com/users/tyler6204/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tyler6204/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/openclaw/openclaw/issues/10208/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/openclaw/openclaw/issues/10208/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed",
  "pinned_comment": null
}
